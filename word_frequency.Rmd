---
title: "Word Frequency"
author: "Logan Calder"
date: "12/12/2017"
output: html_document
---


```{r packages}
library(lubridate)
library(tidytext)
library(tidyverse)
```

```{r load_data}
load("data_processed/strike_reports.RData")
```

```{r}
words_ranked <- strike_reports[1:5,] %>%
    unnest_tokens(output = "word", input = "report_text") %>%
    anti_join(stop_words) %>%
    group_by(
        word
    ) %>% 
    summarize(
        frequency = length(word)
    ) %>%
    arrange(desc(frequency)) %>%
    mutate(
        word = factor(word, levels = word)
    )
```

```{r}
words_ <-
    strike_reports[1:5,] %>%
    unnest_tokens(output = "word", input = "report_text") %>%
    anti_join(stop_words) %>%
    transmute(
        year = year(report_created_date),
        month = month(report_created_date),
        word = factor(word, levels = words_ranked$word)
    ) %>%
    group_by(
        year, month, word
    ) %>%
    summarize(
        frequency = length(word)
    )
View(words_)
```

```{r}
ggplot(words_ranked, mapping = aes(x = word, y = frequency)) + geom_col()

ggplot(words_, mapping = aes(x = word, y = frequency)) + geom_col() + facet_grid(year~month)
```

